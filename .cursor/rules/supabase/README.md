# Supabase AI Rules for Cursor

è¿™ä¸ªæ–‡ä»¶å¤¹åŒ…å«äº†æ‰€æœ‰ Supabase ç›¸å…³çš„ AI ç¼–ç¨‹è§„åˆ™ï¼Œæ¥è‡ª [Supabase å®˜æ–¹ AI Prompts æ–‡æ¡£](https://supabase.com/docs/guides/getting-started/ai-prompts)ã€‚

## ğŸ“ è§„åˆ™æ–‡ä»¶åˆ—è¡¨

### æ ¸å¿ƒè§„åˆ™ï¼ˆå§‹ç»ˆç”Ÿæ•ˆ â­ï¼‰

| æ–‡ä»¶ | ç”¨é€” | çŠ¶æ€ |
|------|------|------|
| **../supabase-guide.md** | æ™ºèƒ½è§„åˆ™è·¯ç”± - è‡ªåŠ¨æ£€æµ‹å¹¶åŠ è½½å¯¹åº”è§„åˆ™ | `alwaysApply: true` â­ |
| **sql-style-guide.md** | PostgreSQL ä»£ç é£æ ¼æŒ‡å— | `alwaysApply: true` â­ |
| **rls-policies.md** | è¡Œçº§å®‰å…¨ç­–ç•¥ï¼ˆRLSï¼‰ç¼–å†™æŒ‡å— | `alwaysApply: true` â­ |

### è¯¦ç»†è§„åˆ™ï¼ˆæŒ‰éœ€è‡ªåŠ¨åŠ è½½ï¼‰

| æ–‡ä»¶ | ç”¨é€” | è§¦å‘å…³é”®è¯ |
|------|------|-----------|
| **realtime.md** | Supabase Realtime å®æ—¶åŠŸèƒ½å¼€å‘æŒ‡å¯¼ | `realtime`, `broadcast`, `presence`, `channel` |
| **nextjs-auth.md** | Next.js + Supabase Auth é›†æˆè§„èŒƒ | `auth`, `signIn`, `session`, `middleware` |
| **edge-functions.md** | Edge Functions ç¼–å†™è§„èŒƒ | `edge function`, `deno`, `supabase/functions/` |
| **declarative-schema.md** | å£°æ˜å¼æ•°æ®åº“æ¶æ„ç®¡ç† | `supabase/schemas/`, `db diff` |
| **database-functions.md** | æ•°æ®åº“å‡½æ•°ç¼–å†™æŒ‡å— | `create function`, `trigger`, `plpgsql` |
| **database-migrations.md** | æ•°æ®åº“è¿ç§»æ–‡ä»¶åˆ›å»ºè§„èŒƒ | `migration`, `supabase/migrations/` |

## ğŸš€ å¦‚ä½•ä½¿ç”¨

### â­ æ™ºèƒ½è‡ªåŠ¨è·¯ç”±ï¼ˆæ¨èï¼‰

é¡¹ç›®å·²é…ç½® **æ™ºèƒ½è§„åˆ™è·¯ç”±** (`.cursor/rules/supabase-guide.md`)ï¼Œå½“ä½ çš„ä»£ç æ¶‰åŠ Supabase æ—¶ï¼ŒAI ä¼šè‡ªåŠ¨ï¼š

1. **æ£€æµ‹åœºæ™¯**ï¼šè¯†åˆ«ä½ åœ¨åšä»€ä¹ˆï¼ˆè®¤è¯ã€RLSã€å®æ—¶åŠŸèƒ½ç­‰ï¼‰
2. **åŠ è½½è§„åˆ™**ï¼šè‡ªåŠ¨å¼•ç”¨å¯¹åº”çš„è¯¦ç»†è§„åˆ™æ–‡ä»¶
3. **ç”Ÿæˆä»£ç **ï¼šæŒ‰ç…§æœ€ä½³å®è·µç”Ÿæˆç¬¦åˆè§„èŒƒçš„ä»£ç 

**ä½ åªéœ€è¦æ­£å¸¸æé—®ï¼š**
```
å¸®æˆ‘åˆ›å»ºä¸€ä¸ªå®æ—¶èŠå¤©åŠŸèƒ½
â†’ AI è‡ªåŠ¨åŠ è½½ realtime.md è§„åˆ™

ä¸º posts è¡¨åˆ›å»º RLS ç­–ç•¥
â†’ AI è‡ªåŠ¨åŠ è½½ rls-policies.md è§„åˆ™

å®ç°ç”¨æˆ·ç™»å½•åŠŸèƒ½
â†’ AI è‡ªåŠ¨åŠ è½½ nextjs-auth.md è§„åˆ™
```

### æ‰‹åŠ¨å¼•ç”¨ï¼ˆå¯é€‰ï¼‰

å¦‚æœéœ€è¦æ˜ç¡®æŒ‡å®šè§„åˆ™ï¼š

1. **é€šè¿‡ @ ç¬¦å·å¼•ç”¨**ï¼š
   ```
   @.cursor/rules/supabase/realtime.md å¸®æˆ‘å®ç°å®æ—¶èŠå¤©åŠŸèƒ½
   ```

2. **åœ¨å¯¹è¯ä¸­å¼•ç”¨**ï¼š
   ```
   æ ¹æ® Supabase Realtime è§„åˆ™ï¼Œå®ç°æˆ¿é—´æ¶ˆæ¯å¹¿æ’­
   ```

### åœ¨å…¶ä»– AI å·¥å…·ä¸­ä½¿ç”¨

- **GitHub Copilot**: ä½¿ç”¨ `#<æ–‡ä»¶å>` å¼•ç”¨
- **Zed**: ä½¿ç”¨ `/file` å‘½ä»¤å¼•ç”¨
- **å…¶ä»–**: å¤åˆ¶è§„åˆ™å†…å®¹åˆ°å¯¹è¯ä¸­

## ğŸ“š è§„åˆ™è¯¦è§£

### 1. Realtime å®æ—¶åŠŸèƒ½
- ä¼˜å…ˆä½¿ç”¨ `broadcast` è€Œé `postgres_changes`
- ä½¿ç”¨ä¸“ç”¨ topic æé«˜æ€§èƒ½
- å§‹ç»ˆä½¿ç”¨ `private: true` å¢å¼ºå®‰å…¨æ€§
- å®ç°é€‚å½“çš„é”™è¯¯å¤„ç†å’Œé‡è¿é€»è¾‘

### 2. Next.js è®¤è¯
- å¿…é¡»ä½¿ç”¨ `@supabase/ssr` åŒ…
- ä»…ä½¿ç”¨ `getAll` å’Œ `setAll` cookie æ–¹æ³•
- ç¦æ­¢ä½¿ç”¨å·²å¼ƒç”¨çš„ `auth-helpers-nextjs`
- æ­£ç¡®é…ç½®ä¸­é—´ä»¶åˆ·æ–°ä»¤ç‰Œ

### 3. Edge Functions
- ä¼˜å…ˆä½¿ç”¨ Web APIs å’Œ Deno æ ¸å¿ƒ API
- ä½¿ç”¨ `npm:` æˆ– `jsr:` å‰ç¼€å¯¼å…¥ä¾èµ–
- å§‹ç»ˆæŒ‡å®šç‰ˆæœ¬å·
- ä½¿ç”¨å†…ç½®çš„ `Deno.serve`

### 4. å£°æ˜å¼ Schema
- æ‰€æœ‰ schema ä¿®æ”¹åœ¨ `supabase/schemas/` ç›®å½•
- ä½¿ç”¨ `supabase db diff` ç”Ÿæˆè¿ç§»
- ç¦æ­¢æ‰‹åŠ¨ä¿®æ”¹ `supabase/migrations/`
- æ³¨æ„å·²çŸ¥é™åˆ¶ï¼ˆDMLã€è§†å›¾æ‰€æœ‰æƒã€RLS ç­‰ï¼‰

### 5. RLS ç­–ç•¥
- ä¸ºæ¯ä¸ªæ“ä½œåˆ›å»ºç‹¬ç«‹ç­–ç•¥
- ä½¿ç”¨ `auth.uid()` è€Œé `current_user`
- ä¸ºç­–ç•¥æ·»åŠ ç´¢å¼•ä»¥æé«˜æ€§èƒ½
- å§‹ç»ˆæŒ‡å®šè§’è‰²ï¼ˆ`to authenticated` / `to anon`ï¼‰

### 6. æ•°æ®åº“å‡½æ•°
- é»˜è®¤ä½¿ç”¨ `SECURITY INVOKER`
- å§‹ç»ˆè®¾ç½® `search_path = ''`
- ä½¿ç”¨å®Œå…¨é™å®šåï¼ˆschema.tableï¼‰
- é€‰æ‹©é€‚å½“çš„å‡½æ•°ç¨³å®šæ€§ï¼ˆIMMUTABLE/STABLE/VOLATILEï¼‰

### 7. æ•°æ®åº“è¿ç§»
- æ–‡ä»¶åæ ¼å¼ï¼š`YYYYMMDDHHmmss_description.sql`
- æ‰€æœ‰ SQL å…³é”®å­—å°å†™
- æ–°è¡¨å¿…é¡»å¯ç”¨ RLS
- ä¸ºç ´åæ€§æ“ä½œæ·»åŠ è¯¦ç»†æ³¨é‡Š

### 8. SQL é£æ ¼æŒ‡å—
- ä½¿ç”¨ snake_case å‘½å
- è¡¨åå¤æ•°ï¼Œåˆ—åå•æ•°
- ä½¿ç”¨ `as` å…³é”®å­—å®šä¹‰åˆ«å
- å¤æ‚æŸ¥è¯¢ä½¿ç”¨ CTE
- ä¸ºæ‰€æœ‰è¡¨æ·»åŠ æ³¨é‡Š

## ğŸ¯ é¡¹ç›®ç‰¹å®šé…ç½®

æ ¹æ®ä½ çš„ `doc-qa-system` é¡¹ç›®éœ€æ±‚ï¼Œä»¥ä¸‹è§„åˆ™ç‰¹åˆ«é‡è¦ï¼š

1. **è®¤è¯ç³»ç»Ÿ** â†’ `nextjs-auth.md`
2. **æ–‡æ¡£æƒé™** â†’ `rls-policies.md`
3. **æ•°æ®åº“è®¾è®¡** â†’ `database-migrations.md` + `sql-style-guide.md`
4. **å®æ—¶é—®ç­”** â†’ `realtime.md`ï¼ˆå¦‚æœéœ€è¦å®æ—¶æ›´æ–°ï¼‰

## ğŸ“– å‚è€ƒé“¾æ¥

- [Supabase AI Prompts å®˜æ–¹æ–‡æ¡£](https://supabase.com/docs/guides/getting-started/ai-prompts)
- [Supabase æ–‡æ¡£](https://supabase.com/docs)
- [PostgreSQL æ–‡æ¡£](https://www.postgresql.org/docs/)

## ğŸ’¡ æœ€ä½³å®è·µ

1. **ä¼˜å…ˆçº§æ’åº**ï¼šå…ˆé˜…è¯» `sql-style-guide.md` å’Œ `rls-policies.md`
2. **å®‰å…¨ç¬¬ä¸€**ï¼šæ‰€æœ‰è¡¨å¿…é¡»å¯ç”¨ RLS
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šä¸ºå¸¸ç”¨æŸ¥è¯¢åˆ—æ·»åŠ ç´¢å¼•
4. **ä»£ç è´¨é‡**ï¼šéµå¾ªå‘½åçº¦å®šå’Œæ ¼å¼è§„èŒƒ
5. **ç‰ˆæœ¬æ§åˆ¶**ï¼šé€šè¿‡è¿ç§»ç®¡ç†æ‰€æœ‰æ•°æ®åº“å˜æ›´

## ğŸ”§ ç»´æŠ¤è¯´æ˜

è¿™äº›è§„åˆ™æ–‡ä»¶åŸºäº Supabase å®˜æ–¹æ–‡æ¡£ï¼ˆ2025å¹´1æœˆç‰ˆæœ¬ï¼‰ã€‚å¦‚éœ€æ›´æ–°ï¼š

1. è®¿é—® [Supabase AI Prompts](https://supabase.com/docs/guides/getting-started/ai-prompts)
2. æ£€æŸ¥æ˜¯å¦æœ‰è§„åˆ™æ›´æ–°
3. æ›´æ–°å¯¹åº”çš„è§„åˆ™æ–‡ä»¶
4. æ›´æ–°æ­¤ README çš„æœ€åæ›´æ–°æ—¥æœŸ

**æœ€åæ›´æ–°**: 2025-01-11

